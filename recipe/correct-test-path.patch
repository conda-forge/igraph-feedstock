diff --git a/etc/cmake/test_helpers.cmake b/etc/cmake/test_helpers.cmake
index 693ba3c28..501f92dde 100644
--- a/etc/cmake/test_helpers.cmake
+++ b/etc/cmake/test_helpers.cmake
@@ -70,8 +70,20 @@ function(add_legacy_test FOLDER NAME NAMESPACE)
 
     # Semicolons are used as list separators in CMake so we need to escape them in the PATH,
     # otherwise the PATH envvar gets split by CMake before it passes the PATH on to CTest.
-    string(JOIN "\;" CORRECT_PATH $ENV{PATH})
-    SET_TESTS_PROPERTIES(${TEST_NAME} PROPERTIES ENVIRONMENT "PATH=${IGRAPH_LIBDIR}\;${CORRECT_PATH}" )
+    # We process each path separately to ensure it is a proper path. In particular, we need
+    # to ensure that a trailing backslash is not incorrectly interpreted as an escape
+    # character. Presumably, with cmake 3.20, this can be changed to using TO_NATIVE_PATH_LIST.
+    SET(TEST_PATHS)
+    foreach (PATH $ENV{PATH})
+      file(TO_NATIVE_PATH "${PATH}" CORRECT_PATH)
+      # Remove trailing backslash
+      STRING(REGEX REPLACE "\\$" "" CORRECT_PATH ${CORRECT_PATH})
+      list(APPEND TEST_PATHS ${CORRECT_PATH})
+    endforeach()
+
+    # Join all paths in a single string, separated by an escaped semi-colon.
+    string(JOIN "\;" CORRECT_PATHS ${TEST_PATHS})
+    SET_TESTS_PROPERTIES(${TEST_NAME} PROPERTIES ENVIRONMENT "PATH=${IGRAPH_LIBDIR}\;${CORRECT_PATHS}" )
   endif()
 endfunction()
 
